<!DOCTYPE html>
<html lang="en">
  <script>
    fetch("head.html")
      .then((res) => res.text())
      .then((html) => {
        document.head.insertAdjacentHTML("beforeend", html);
      });
  </script>
  <body>
    <div id="header-navbar"></div>
    <section class="pricing-section">
      <h2>Most Affordable Prices in Town!</h2>
      <div id="pricing-section"></div>
    </section>
    <div id="footer"></div>

    <script src="pricing.js"></script>
    <script>
      // Load components and initialize carousel after content is loaded
      async function initializePage() {
        try {
          // Load header and footer (these can load in parallel)
          const headerPromise = HTMLLoader.loadComponent(
            "header-navbar",
            "header-navbar.html"
          );
          const footerPromise = HTMLLoader.loadComponent(
            "footer",
            "footer.html"
          );

          // Load pricing HTML first and wait for it to complete
          await HTMLLoader.loadComponent(
            "pricing-section",
            "pricing-section.html"
          );

          // Now that pricing HTML is loaded, initialize the carousel
          // Add a small delay to ensure DOM is fully updated
          setTimeout(() => {
            const pricingCarousel = new PricingCarousel("pricingCarousel", {
              cardsPerView: 3,
              enableTouch: true,
              enableDots: true,
              enableArrows: true,
              autoSlide: false,
            });

            // Store reference for later use
            window.pricingCarousel = pricingCarousel;
            console.log("Pricing carousel initialized successfully");
          }, 100);

          // Wait for header and footer to finish loading
          await Promise.all([headerPromise, footerPromise]);
        } catch (error) {
          console.error("Error initializing page:", error);
        }
      }

      // Initialize everything when DOM is ready
      document.addEventListener("DOMContentLoaded", initializePage);
    </script>
  </body>
</html>
